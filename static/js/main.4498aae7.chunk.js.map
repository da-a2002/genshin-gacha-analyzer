{"version":3,"sources":["components/IconButton.tsx","utils/renderPngTip.ts","const.ts","context/GlobalContext.tsx","pages/LoadPage.tsx","resource/achievement_achieved.png","resource/achievement_show.png","components/AchievementCard.tsx","utils/index.ts","pages/ShowPage/Achievements/achievements.ts","pages/ShowPage/Achievements/renderToCanvas.ts","pages/ShowPage/Achievements/index.tsx","pages/ShowPage/CustomSider.tsx","pages/ShowPage/index.tsx","pages/DownloadPage/parseUrl.ts","pages/DownloadPage/index.tsx","App.tsx","reportWebVitals.ts","index.tsx","components/FriendLinks.tsx","context/CacheContext.tsx"],"names":["floatButtonStyle","css","IconButton","placement","tip","icon","onClick","title","type","id","renderPngTip","func","key","message","loading","content","Promise","then","success","e","console","log","error","ISMOBILE","isMobile","window","navigator","any","SHOW_DATA_ALL_KEY","FONT_FAMILY","FONT_FAMILY_BOLD","COLOR","FOUR_STAR","FIVE_STAR","THREE_STAR","numberFilter","value","filterFor","toString","SCHEMA","name","width","hidden","filter","SCHEMA_ALL","concat","CHARACTER_POOLS","from","to","five","four","map","v","o","Date","WEAPON_POOLS","GlobalContext","React","createContext","workbook","isVertical","updateWorkbook","getInfo","clientWidth","document","body","clientHeight","useGlobalContext","useContext","GlobalContextProvider","children","useState","setWorkbook","initInfo","useMemo","setVertical","isVerticalRef","useRef","useEffect","current","resize","nowIsVertical","addEventListener","removeEventListener","Provider","Dragger","Upload","LoadPage","onLoad","setLoading","errorMessage","setErrorMessage","loadingTip","setLoadingTip","handleUpload","useCallback","file","endsWith","reader","FileReader","onload","module","XLSX","data","Uint8Array","target","result","read","catch","onerror","readAsArrayBuffer","className","href","showIcon","banner","accept","multiple","beforeUpload","showUploadList","FriendLinks","mode","visible","AchievementCard","info","achievedTime","isAchieved","style","backgroundColor","src","AchievedPng","height","ShowPng","undefined","isWeapon","item","类别","defaultFormatter","count","formatTime","str","slice","replace","achievements","all","maxBy","Object","keys","cur","items","保底内","名称","时间","minBy","pools","matches","character","length","push","weapon","novice","permanent","星级","notHitCount","hitCount","i","isHitUp","obj","date","pool","find","includes","day","_day","values","today","resultStr","format","cache","forEach","formatByName","join","sort","a","b","总次数","waitTime","index","maxWaitTime","max","level","t","indexOf","fromTime","endTime","waitDay","Math","floor","gacha","starFilter","limitFilter","gacha1Data","gacha10Data","reduce","acc","gacha1Count","gacha10Count","gachaFiveStarCountArr","fiveStarCount","lastIndexOf","extraInfo","isFit","list","getFourFiveStarCount","countMoreThanFourList","getWeaponCount","maxData","maxCount","sortedData","maxNum","endIndex","findIndex","names","WIDTH","getFont","size","drawText","ctx","text","letterSpace","lineHeight","props","loc","x","y","chars","split","match","font","Error","parseFloat","save","restore","char","charWidth","measureText","draw","sx","sy","fillText","loadImage","create","cb","Array","isArray","image","Image","f","drawImage","callback","drawOneAchievement","achievement","BORDER_MARGIN_W","BORDER_WIDTH","SIZE","HEIGHT","LEFT_PADDING","left","top","contentHeight","drawLeftZone","LEFT_ZONE_WIDTH","drawLeft","realImageWidth","right","drawValue","fillStyle","textBaseline","drawRightZone","RIGHT_ZONE_WIDTH","drawRight","PADDING_TOP","PADDING_BOTTOM","SPACE","titleHeight","drawTitle","infoHeight","drawInfo","drawContentZone","fontHeight","drawContent","fillRect","strokeStyle","lineWidth","lineJoin","strokeRect","MARGIN_W","MARGIN_H","renderToCanvas","canvas","createElement","getContext","alpha","draws","fontWidth","lineCap","centerY","beginPath","moveTo","lineTo","closePath","stroke","drawEndLine","endLineHeight","drawEnd","POOLS","CN_SHEETS","getSheetKey","sheetNames","iconCss","WrappedAchievementCard","isEditMode","isVisible","setVisible","handleHide","opacity","position","twoToneColor","Achievements","onGetData","allAchievements","useCacheMemo","allData","10","1","walk","currentDay","len","temp","achievementsFunc","setAchievements","setEditMode","handleRenderPng","resolve","reject","toBlob","blob","saveAs","handleEdit","Sider","Layout","Header","GithubCorner","memo","direction","bannerColor","octoColor","isVerticalMenuStyle","notIsVerticalMenuStyle","CustomSider","onMenuChange","activeMenu","defaultSelectedKeys","onSelect","Item","breakpoint","theme","ShowData","lazy","default","Timeline","AnalysisChart","Content","ShowPage","SheetNames","getJson","sheet","Sheets","utils","sheet_to_json","parseInt","setActiveMenu","handleMenuChange","renderContent","tabs","flexDirection","CacheContext","path","fallback","emptyLog","logRef","parseUrl","inputUrl","apiDomain","qs","url","query","lang","book_new","request","res","gachaTypes","gacha_type_list","orderedGachaTypes","order","splice","getGachaType","types","code","page","end_id","gacha_type","getGachaLog","isEnd","setTimeout","getGachaLogs","pdx","star","rank_type","time","item_type","unshift","ws","aoa_to_sheet","book_append_sheet","wbout","write","bookType","bookSST","Blob","main","baseUrl","params","stringifyUrl","wrappedFetch","attempt","fetch","headers","response","json","DownloadPage","setMessage","messageHistory","exportFuncRef","isValid","setValid","handleExport","handleInputChange","debounce","valid","TextArea","placeholder","onChange","App","location","pathname","WrappedApp","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","Links","link","EllipsisStyle","Separator","GlobalCache","useCacheContext","CacheContextProvider","initValue","parentCache","contextValue","deps","useCacheState","state","setValue","createCacheContext"],"mappings":"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","file":"static/js/main.4498aae7.chunk.js","sourcesContent":["/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport React, { FC } from 'react';\nimport { Button, ButtonProps, Tooltip, TooltipProps } from 'antd';\n\ntype IconButtonProps = {\n  placement?: TooltipProps['placement'];\n  tip?: TooltipProps['title'];\n  icon: ButtonProps['icon'];\n  onClick?: ButtonProps['onClick'];\n};\nconst floatButtonStyle = css`\n  width: 40px;\n  height: 40px;\n  background: #fff;\n  color: #8590a6;\n  font-size: 20px;\n  box-shadow: 0 1px 3px rgb(18 18 18 / 10%);\n  margin: 5px;\n  border-color: transparent;\n  border-radius: 4px;\n  &:active {\n    background: #fff;\n    color: #8590a6;\n  }\n  &:focus {\n    background: #fff;\n    color: #8590a6;\n  }\n  &:hover {\n    background: #d3d3d3;\n  }\n`;\n\nexport const IconButton: FC<IconButtonProps> = function ({ placement, tip, icon, onClick }) {\n  return (\n    <Tooltip placement={placement} title={tip}>\n      <Button icon={icon} onClick={onClick} css={floatButtonStyle} type='text' />\n    </Tooltip>\n  );\n};\n","import { message } from 'antd';\n\nlet id = 0;\n\nexport default function renderPngTip(func: (resolve: () => void, reject: () => void) => void) {\n  const key = `${id++}`;\n  message.loading({\n    content: '生成图片中...',\n    key,\n  });\n  const loading = new Promise(func as any);\n  loading.then(\n    () => {\n      message.success({\n        content: '生成图片成功',\n        key,\n      });\n    },\n    (e: any) => {\n      console.log(e);\n      message.error({\n        content: '生成图片失败，请重试或更换浏览器',\n        key,\n      });\n    },\n  );\n}\n","import { PoolType } from 'types';\nimport isMobile from 'ismobilejs';\n\nexport const DEVICE = isMobile(window.navigator);\n\nexport const ISMOBILE = DEVICE.any;\n\nexport const SHOW_DATA_ALL_KEY = '总览';\n\nexport const FONT_FAMILY = 'HYWenHei-65W';\nexport const FONT_FAMILY_BOLD = 'HYWenHei-85W';\n\nexport const COLOR = {\n  FOUR_STAR: '#A65FE2',\n  FIVE_STAR: '#C0713D',\n  THREE_STAR: '#4D8DF7',\n};\n// fix: canvas-datagrid have error when filter number\nconst numberFilter = function (value: number, filterFor: string | undefined) {\n  if (!filterFor) {\n    return true;\n  }\n  return value.toString() === filterFor;\n};\nexport const SCHEMA = [\n  { name: '时间', type: 'string', width: 200 },\n  { name: '编号', type: 'number', hidden: true, width: 120, filter: numberFilter },\n  { name: '名称', type: 'string', width: 130 },\n  { name: '类别', type: 'string', width: 50 },\n  { name: '星级', type: 'number', width: 50, filter: numberFilter },\n  { name: '总次数', type: 'number', hidden: true, width: 100, filter: numberFilter },\n  { name: '保底内', type: 'number', width: 80, filter: numberFilter },\n];\n\nexport const SCHEMA_ALL = (SCHEMA as any).concat({\n  name: 'pool',\n  title: '池子名称',\n  type: 'string',\n  width: 120,\n});\n\nexport const CHARACTER_POOLS: PoolType[] = [\n  {\n    from: '2020-9-28 06:00:00',\n    to: '2020-10-18 17:59:59',\n    five: ['温迪'],\n    four: ['芭芭拉', '菲谢尔', '香菱'],\n    name: '杯装之诗',\n  },\n  {\n    from: '2020-10-20 18:00:00',\n    to: '2020-11-10 14:59:59',\n    five: ['可莉'],\n    four: ['行秋', '诺艾尔', '砂糖'],\n    name: '闪焰的驻足',\n  },\n  {\n    from: '2020-11-11 06:00:00',\n    to: '2020-12-01 15:59:59',\n    five: ['达达利亚'],\n    four: ['迪奥娜', '北斗', '凝光'],\n    name: '暂别冬都',\n  },\n  {\n    from: '2020-12-01 18:00:00',\n    to: ' 2020-12-22 14:59:59',\n    five: ['钟离'],\n    four: ['辛焱', '雷泽', '重云'],\n    name: '陵薮市朝',\n  },\n  {\n    from: '2020-12-23 06:00:00',\n    to: '2021-01-12 15:59:59',\n    five: ['阿贝多'],\n    four: ['菲谢尔', '砂糖', '班尼特'],\n    name: '深秘之息',\n  },\n  {\n    from: '2021-01-12 18:00:00',\n    to: '2021-02-02 14:59:59',\n    five: ['甘雨'],\n    four: ['香菱', '行秋', '诺艾尔'],\n    name: '浮生孰来',\n  },\n  {\n    from: '2021-02-03 06:00:00',\n    to: '2021-02-17 15:59:59',\n    five: ['魈'],\n    four: ['迪奥娜', '北斗', '辛焱'],\n    name: '烟火之邀',\n  },\n  {\n    from: '2021-02-17 18:00:00',\n    to: '2021-03-02 15:59:59',\n    five: ['刻晴'],\n    four: ['凝光', '班尼特', '芭芭拉'],\n    name: '鱼龙灯昼',\n  },\n  {\n    from: '2021-03-02 18:00:00',\n    to: '2021-03-16 14:59:59',\n    five: ['胡桃'],\n    four: ['行秋', '香菱', '重云'],\n    name: '赤团开时',\n  },\n  {\n    from: '2021-03-17 06:00:00',\n    to: '2021-04-06 15:59:59',\n    five: ['温迪'],\n    four: ['砂糖', '雷泽', '诺艾尔'],\n    name: '杯装之诗',\n  },\n].map((v) => {\n  const o: PoolType = v as any;\n  o.from = +new Date(v.from);\n  o.to = +new Date(v.to);\n  o.type = 'character';\n  return o;\n});\nexport const WEAPON_POOLS: PoolType[] = [\n  {\n    from: '2020-10-20 18:00:00',\n    to: '2020-11-10 14:59:59',\n    five: ['四风原典', '狼的末路'],\n    four: ['祭礼剑', '祭礼大剑', '祭礼残章', '祭礼弓', '匣里灭辰'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2020-11-11 06:00:00',\n    to: '2020-12-01 15:59:59',\n    five: ['天空之翼', '尘世之锁'],\n    four: ['笛剑', '雨裁', '昭心', '弓藏', '西风长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2020-12-01 18:00:00',\n    to: ' 2020-12-22 14:59:59',\n    five: ['贯虹之槊', '无工之剑'],\n    four: ['匣里龙吟', '钟剑', '西风秘典', '西风猎弓', '匣里灭辰'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2020-12-23 06:00:00',\n    to: '2021-01-12 15:59:59',\n    five: ['斫峰之刃', '天空之卷'],\n    four: ['西风剑', '西风大剑', '西风长枪', '祭礼残章', '绝弦'],\n    name: '神铸赋形',\n  },\n\n  {\n    from: '2021-01-12 18:00:00',\n    to: '2021-02-02 14:59:59',\n    five: ['阿莫斯之弓', '天空之傲'],\n    four: ['祭礼剑', '钟剑', '匣里灭辰', '昭心', '西风猎弓'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-02-03 06:00:00',\n    to: '2021-02-23 15:59:59',\n    five: ['磐岩结绿', '和璞鸢'],\n    four: ['笛剑', '祭礼大剑', '弓藏', '昭心', '西风长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-02-23 18:00:00',\n    to: '2021-03-16 14:59:59',\n    five: ['护摩之杖', '狼的末路'],\n    four: ['匣里龙吟', '千岩古剑', '祭礼弓', '流浪乐章', '千岩长枪'],\n    name: '神铸赋形',\n  },\n  {\n    from: '2021-03-17 06:00:00',\n    to: '2021-04-06 15:59:59',\n    five: ['终末嗟叹之诗', '天空之刃'],\n    four: ['暗巷闪光', '西风大剑', '西风猎弓', '暗巷的酒与诗', '匣里灭辰'],\n    name: '神铸赋形',\n  },\n].map((v) => {\n  const o: PoolType = v as any;\n  o.from = +new Date(v.from);\n  o.to = +new Date(v.to);\n  o.type = 'weapon';\n  return o;\n});\n","import React, { useEffect, useMemo, useRef, useState, FC, useContext } from 'react';\nimport { WorkBook } from 'xlsx/types';\n\ntype GlobalContextType = {\n  workbook: WorkBook | null;\n  isVertical: boolean;\n  updateWorkbook: (workbook: WorkBook) => void;\n};\n\nexport const GlobalContext = React.createContext<GlobalContextType>({\n  workbook: null,\n  isVertical: false,\n  updateWorkbook: (() => {}) as any,\n});\n\n// 获取尺寸信息\nfunction getInfo() {\n  const clientWidth = document.body.clientWidth;\n  const clientHeight = document.body.clientHeight;\n  return {\n    clientWidth,\n    clientHeight,\n    isVertical: clientHeight > clientWidth,\n  };\n}\nexport const useGlobalContext = function () {\n  return useContext(GlobalContext);\n};\n\nexport const GlobalContextProvider: FC<{}> = function ({ children }) {\n  const [workbook, setWorkbook] = useState<WorkBook | null>(null);\n  const initInfo = useMemo(() => getInfo(), []);\n  const [isVertical, setVertical] = useState(initInfo.isVertical);\n  const isVerticalRef = useRef<boolean>(isVertical);\n  useEffect(() => {\n    isVerticalRef.current = isVertical;\n  }, [isVertical]);\n  useEffect(() => {\n    function resize() {\n      const { isVertical: nowIsVertical } = getInfo();\n      if (nowIsVertical !== isVerticalRef.current) setVertical(nowIsVertical);\n    }\n    window.addEventListener('resize', resize);\n    return () => {\n      window.removeEventListener('resize', resize);\n    };\n  }, []);\n  const value = useMemo(() => {\n    return {\n      workbook: workbook,\n      updateWorkbook: setWorkbook,\n      isVertical,\n    };\n  }, [isVertical, workbook]);\n  return <GlobalContext.Provider value={value}>{children}</GlobalContext.Provider>;\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, useCallback, useState } from 'react';\nimport { Button, Upload, Alert, Spin } from 'antd';\nimport InboxOutlined from '@ant-design/icons/InboxOutlined';\nimport { RcFile } from 'antd/lib/upload';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport XLSXNameSpace from 'xlsx/types';\nimport { FriendLinks } from 'components/FriendLinks';\n\nconst { Dragger } = Upload;\ntype LoadPageProps = {\n  onLoad?: () => void;\n};\n// 预加载\n// @ts-ignore\nimport('xlsx/dist/xlsx.mini.min.js');\n\nexport const LoadPage: FC<LoadPageProps> = function ({ onLoad }) {\n  const [loading, setLoading] = useState<Boolean>(false);\n  const [errorMessage, setErrorMessage] = useState<String | null>(null);\n  const [loadingTip, setLoadingTip] = useState('加载中...');\n  const { updateWorkbook } = useGlobalContext();\n  const handleUpload = useCallback((file: RcFile) => {\n    if (!file.name.endsWith('.xlsx')) {\n      setErrorMessage('文件类型错误，请上传xlsx文件');\n      return false;\n    }\n    setLoading(true);\n    const reader = new FileReader();\n    reader.onload = function (e: ProgressEvent<FileReader>) {\n      setLoadingTip('xlsx解析文件加载中...');\n      // @ts-ignore\n      import('xlsx/dist/xlsx.mini.min.js')\n        .then((module) => {\n          (window as any).XLSX = module;\n          const XLSX: typeof XLSXNameSpace = module;\n          const data = new Uint8Array((e.target as FileReader).result as any);\n          const workbook = XLSX.read(data, { type: 'array' });\n          updateWorkbook(workbook);\n        })\n        .catch(() => {\n          setErrorMessage('XLSX解析文件加载失败，请重新上传');\n        });\n    };\n    reader.onerror = function (e: ProgressEvent<FileReader>) {\n      setErrorMessage('解析文件失败, 请重新上传');\n      setLoading(false);\n    };\n    reader.readAsArrayBuffer(file);\n    return false;\n  }, []);\n  return (\n    <div\n      css={css`\n        overflow: auto;\n      `}\n    >\n      <div\n        className='ant-alert-info'\n        css={css`\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          border: none;\n          margin: 20px 0;\n        `}\n      >\n        <a href='https://ngabbs.com/read.php?tid=25657464' target='_blank'>\n          <Alert\n            message={\n              <div>\n                不知道如何获取抽卡记录导出文件？\n                <Button type='link'>请点击这里</Button>\n              </div>\n            }\n            type='info'\n            showIcon\n            banner\n          />\n        </a>\n      </div>\n      <Dragger\n        name='file'\n        accept='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, .xlsx'\n        multiple={false}\n        beforeUpload={handleUpload}\n        showUploadList={false}\n        css={css`\n          width: 100%;\n          max-width: 600px;\n          margin: 0 auto;\n          padding: 40px;\n        `}\n      >\n        {errorMessage && <Alert message={errorMessage} type='error' />}\n        <p className='ant-upload-drag-icon'>\n          {loading ? <Spin tip={loadingTip} /> : <InboxOutlined />}\n        </p>\n        <p className='ant-upload-text'>点击选择抽卡记录导出文件或将文件拖拽到此区域</p>\n        <p className='ant-upload-text'>( 注：文件的后缀应为.xlsx )</p>\n      </Dragger>\n      <Alert\n        css={css`\n          margin: 20px auto;\n          width: 100%;\n          max-width: 600px;\n        `}\n        message={\n          <div>\n            此网站是静态网站，你的文件不会被上传到网站后台，具体代码请查看\n            <Button\n              type='link'\n              href='https://github.com/voderl/genshin-gacha-analyzer'\n              target='_blank'\n            >\n              github链接\n            </Button>\n          </div>\n        }\n        type='warning'\n        showIcon\n      />\n      <FriendLinks mode='bottom' visible />\n    </div>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/achievement_achieved.49d0cc2e.png\";","export default __webpack_public_path__ + \"static/media/achievement_show.b270d366.png\";","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport React, { FC, useCallback, useMemo } from 'react';\nimport UnAchievedPng from 'resource/achievement_unachieve.png';\nimport AchievedPng from 'resource/achievement_achieved.png';\nimport ShowPng from 'resource/achievement_show.png';\n\nexport type AchievementCardProps = {\n  title: string;\n  info: string;\n  value?: string | number;\n  achievedTime?: string;\n};\n\nexport const AchievementCard: FC<AchievementCardProps> = function ({\n  title,\n  info,\n  value,\n  achievedTime,\n  children,\n}) {\n  const isAchieved = !!achievedTime;\n  return (\n    <div\n      style={{\n        // backgroundColor: isAchieved ? '#ebe2d8' : '#f5f1eb',\n        backgroundColor: '#ebe2d8',\n      }}\n      css={css`\n        position: relative;\n        width: 100%;\n        max-width: 800px;\n        min-height: 100px;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        border: 2px solid #e0d6cb;\n        color: #bca895;\n        color: #988b81;\n        font-size: 16px;\n        margin: 4px auto;\n      `}\n    >\n      {children}\n      <img\n        src={/* isAchieved ? AchievedPng : UnAchievedPng */ AchievedPng}\n        width='104'\n        height='104'\n        css={css`\n          margin: 0 16px;\n          width: 80px;\n          height: 80px;\n        `}\n      />\n      <div\n        css={css`\n          flex: 1 1;\n          padding: 12px 0;\n          p {\n            margin-bottom: 4px;\n          }\n        `}\n      >\n        <p\n          css={css`\n            color: #585757;\n            font-size: 20px;\n          `}\n        >\n          {title}\n        </p>\n        <p>{info}</p>\n      </div>\n      {isAchieved ? (\n        <div\n          css={css`\n            width: 128px;\n            margin-left: 12px;\n            height: 96px;\n            background: url(${ShowPng}) no-repeat right/cover;\n            display: flex;\n            flex-direction: column;\n            justify-content: flex-end;\n            align-items: center;\n          `}\n        >\n          <span\n            css={css`\n              font-size: 20px;\n            `}\n          >\n            {value === undefined ? '达成' : value}\n          </span>\n          <span\n            css={css`\n              padding: 8px 0 0px;\n              font-size: 15px;\n            `}\n          >\n            {achievedTime}\n          </span>\n        </div>\n      ) : (\n        value !== undefined && (\n          <div\n            css={css`\n              width: 128px;\n              height: 96px;\n              background-color: #ebe2d8;\n              text-align: center;\n            `}\n          >\n            <span\n              css={css`\n                line-height: 96px;\n                font-size: 20px;\n              `}\n            >\n              {value}\n            </span>\n          </div>\n        )\n      )}\n    </div>\n  );\n};\n","import { DataItem } from 'types';\n\nexport const isWeapon = (item: DataItem) => item.类别 === '武器';\n","import { Data, DataItem, Source } from 'types';\nimport maxBy from 'lodash/maxBy';\nimport minBy from 'lodash/minBy';\nimport max from 'lodash/max';\nimport { AchievementCardProps } from 'components/AchievementCard';\nimport { CHARACTER_POOLS } from 'const';\nimport { isWeapon } from 'utils';\n\n/**\n * 成就计算相互独立，每个为一个函数，传入给定的参数，返回规定的格式。具体参数和返回格式见下面。\n */\ntype Show = {\n  单个数据类型: DataItem;\n  函数返回类型: AchievementCardProps | AchievementCardProps[]; // 返回flase， undefined表示没有\n  传入参数展示: {\n    // 在开发模式下传入参数会在控制台输出\n    character: {\n      5: {\n        七七: {\n          data: DataItem[]; // 七七的所有抽卡记录\n        };\n      };\n      4: '同上';\n    };\n    weapon: {\n      5: {\n        狼的末路: {\n          data: DataItem[]; // 狼的末路的所有抽卡记录\n        };\n      };\n      4: '同上';\n      3: '同上';\n    };\n    all: '结构同上，包含角色与武器';\n    gacha: {\n      10: [DataItem[]]; // 十抽数据的数组,\n      1: [DataItem]; // 单抽数据的数组\n    };\n    data: DataItem[]; // 全部抽卡记录源数据\n    day: {\n      // 不同天数的抽卡记录\n      '2020-9-16': {\n        data: DataItem[];\n      };\n    };\n    pools: {\n      character: DataItem[]; // 人物Up池所有抽卡\n      weapon: DataItem[]; // 武器up池数据\n      novice: DataItem[]; //  新手池数据\n      permanent: DataItem[]; // 常驻池数据\n    };\n  };\n};\n\nfunction toPercent(point: number) {\n  return Number(point * 100).toFixed(2) + '%';\n}\nconst defaultFormatter = (name: string, count: number) =>\n  `「${name}」` + (count === 1 ? '' : `×${count}`);\nfunction formatByName(data: Data, format = defaultFormatter) {\n  const cache: any = {};\n  data.forEach((item) => {\n    if (item.名称 in cache) cache[item.名称] += 1;\n    else cache[item.名称] = 1;\n  });\n  return Object.keys(cache).map((key) => format(key, cache[key]));\n}\nconst formatTime = (str: string) => str.slice(0, 10).replace(/-/g, '/');\nconst calculateTime = (t: number) => {\n  var d = Math.floor(t / 1000 / 60 / 60 / 24);\n  var h = Math.floor((t / 1000 / 60 / 60) % 24);\n  return d + ' 天' + h + ' 时';\n};\nexport const achievements: Array<(\n  data: Source,\n) => AchievementCardProps | AchievementCardProps[] | false | void> = [\n  function maxGacha({ all }: Source) {\n    const name = maxBy(Object.keys(all[5]), (cur) => {\n      const items = all[5][cur].data;\n      return (maxBy(items, (item) => item.保底内) as DataItem).保底内;\n    });\n    if (!name) return false;\n    const item = maxBy(all[5][name].data, (item) => item.保底内);\n    if (!item) return false;\n    if (item.保底内 < 80) return;\n    let info = '';\n    if (item.保底内 >= 84) {\n      info = ', 你竟是' + ['百', '千', '万', '十万', '百万'][item.保底内 - 84] + '里挑一的非酋!';\n    }\n    return {\n      title: '「原来非酋竟是我自己」',\n      info: `抽了 ${item.保底内} 次才最终抽到了「${item.名称}」${info}`,\n      achievedTime: item.时间,\n      value: item.保底内,\n    };\n  },\n  function minGacha({ all }: Source) {\n    const name = minBy(Object.keys(all[5]), (cur) => {\n      const items = all[5][cur].data;\n      return (minBy(items, (item) => item.保底内) as DataItem).保底内;\n    });\n    if (!name) return false;\n    const item = minBy(all[5][name].data, (item) => item.保底内);\n    if (!item) return false;\n    const count = item.保底内;\n    if (count > 30) return;\n    let info = '';\n    if (count <= 5) info = `, 你的欧气无人能敌!`;\n    return {\n      title: '「欧皇时刻」',\n      info: `只抽了 ${item.保底内} 次就抽到了「${item.名称}」${info}`,\n      achievedTime: item.时间,\n      value: item.保底内,\n    };\n  },\n  // 不碰某些池子\n  function ({ pools }) {\n    const matches = [];\n    if (pools.character.length === 0)\n      matches.push({\n        title: '「角色Up池? 不稀罕!」',\n        info: '没有在「角色活动祈愿」中进行抽卡',\n      });\n    if (pools.weapon.length === 0)\n      matches.push({\n        title: '「武器池？能吃吗？」',\n        info: '没有在「武器活动祈愿」中进行抽卡',\n      });\n    if (pools.novice.length === 0)\n      matches.push({\n        title: '「永远的新手」',\n        info: '没有在「新手祈愿」中进行抽卡',\n      });\n    if (pools.permanent.length === 0)\n      matches.push({\n        title: '「传说中的毒池」',\n        info: '没有在「常驻祈愿」中进行抽卡',\n      });\n    return matches;\n  },\n  // 人物Up池歪的比例\n  function upWrong({ pools }) {\n    const data = pools.character.filter((data) => data.星级 === 5);\n    if (data.length === 0) return;\n    // 是否是Up角色\n    function isHitUp(item: DataItem) {\n      const date = item.date;\n      const pool = CHARACTER_POOLS.find((pool) => date >= pool.from && date <= pool.to);\n      if (!pool) return false;\n      return pool.five.includes(item.名称);\n    }\n    let notHitCount = 0,\n      hitCount = 0;\n    for (let i = 0; i < data.length; i++) {\n      if (isHitUp(data[i])) {\n        hitCount++;\n      } else {\n        i++;\n        notHitCount++;\n      }\n    }\n    const obj = {\n      value: `${notHitCount} / ${hitCount + notHitCount}`,\n      achievedTime: '小保底歪的概率',\n    };\n    if (notHitCount === 0)\n      return {\n        title: '「不倒翁」',\n        info: `在「角色活动祈愿」中抽中的五星角色均为当期Up角色`,\n        ...obj,\n      };\n    if (hitCount > notHitCount)\n      return {\n        title: '「晴时总比雨时多」',\n        info: `在「角色活动祈愿」中，小保底偏向于抽中当期Up角色`,\n        ...obj,\n      };\n    if (hitCount === notHitCount)\n      return {\n        title: '「晴雨各半」',\n        info: `在「角色活动祈愿」中小保底歪与不歪持平`,\n        ...obj,\n      };\n    return {\n      title: '「雨时偏比晴时多」',\n      info: `在「角色活动祈愿」中，小保底偏向于没有抽中当期Up角色`,\n      ...obj,\n    };\n  },\n  function maxGachaDay({ day, data }) {\n    const _day = maxBy(Object.values(day), (today) => today.data.length);\n    if (!_day) return false;\n    const result = _day.data.filter((item) => item.星级 === 5);\n    if (result.length === 0)\n      return {\n        // from nga @carry_tu (https://ngabbs.com/nuke.php?func=ucp&uid=41767591)\n        title: '「最黑暗的一天」', // 最多抽数的一天且并没有出黄\n        info: `在${formatTime(_day.data[0].时间)}这一天，你共抽取了 ${\n          _day.data.length\n        } 次，然而并没有出黄，是抽卡记录中最黑暗的一天`,\n        achievedTime: _day.data[0].时间,\n        value: _day.data.length,\n      };\n    const resultStr = `在抽到${formatByName(result).join('、')}时，你有没有很开心呢？`;\n    return {\n      title: '「豪掷千金」',\n      info: `在${formatTime(_day.data[0].时间)}这一天，你共抽取了 ${\n        _day.data.length\n      } 次。${resultStr}`,\n      achievedTime: _day.data[0].时间,\n      value: _day.data.length,\n    };\n  },\n  function CangshuExpert({ pools }) {\n    const { character, weapon } = pools;\n    const data = character\n      .concat(weapon)\n      .sort((a, b) => (a.date === b.date ? a.总次数 - b.总次数 : a.date - b.date));\n    const waitTime = data.slice(1).map((v, index) => v.date - data[index].date);\n    if (waitTime.length === 0) return;\n    const maxWaitTime = max(waitTime as Array<number>);\n    if (!maxWaitTime) return;\n    const index = waitTime.indexOf(maxWaitTime);\n    const fromTime = data[index].时间,\n      endTime = data[index + 1].时间;\n    const waitDay = maxWaitTime / 3600 / 24 / 1000;\n    let level, info;\n    if (waitDay <= 15) {\n      level = '随缘';\n      info = '是一只不太合格的仓鼠呢~';\n    } else if (waitDay <= 30) {\n      level = '合格';\n      info = '你已经是一只合格的仓鼠了';\n    } else if (waitDay <= 60) {\n      level = '专家';\n      info = '作为仓鼠，你就是专家!';\n    } else {\n      level = '大师';\n      info = '您的传说受到了众仓鼠的景仰!';\n    }\n    return {\n      title: `「${level}仓鼠」`,\n      info: `从${formatTime(fromTime)}到${formatTime(\n        endTime,\n      )}没有使用「纠缠之缘」进行抽卡。${info}`,\n      value: calculateTime(maxWaitTime),\n      achievedTime: '持续时间',\n    };\n  },\n  function oneGachaGetFiveStar({ gacha }) {\n    const countLimit = 40; // 限制抽数，避免你看要保底了就单抽，而导致假的单抽出奇迹\n    const percentLimit = 0.3;\n    const starFilter = (item: DataItem) => item.星级 === 5;\n    const limitFilter = (item: DataItem) => item.保底内 <= countLimit;\n    const gacha1Data = gacha[1].filter(limitFilter); // 所有满足条件的单抽\n    const gacha10Data = gacha[10].reduce((acc, cur) => {\n      return acc.concat(cur.data.filter(limitFilter));\n    }, [] as DataItem[]);\n    const gacha1Count = gacha1Data.filter(starFilter).length;\n    const gacha10Count = gacha10Data.filter(starFilter).length;\n    if (gacha1Count === 0 && gacha10Count === 0) return;\n    let info = [];\n    if (gacha1Count) info.push(`通过单抽获取的数目为 ${gacha1Count}`);\n    if (gacha10Count) info.push(`通过十连获取的数目为 ${gacha10Count}`);\n    const data = {\n      info: `在 ${countLimit} 抽内获取 5 星共计 ${gacha1Count + gacha10Count} 次，其中${info.join(\n        '，',\n      )}`,\n    };\n    if (gacha1Count / gacha10Count < percentLimit) {\n      return {\n        title: '「十连出奇迹(√)」',\n        ...data,\n      };\n    }\n    if (gacha10Count / gacha1Count < percentLimit) {\n      return {\n        title: '「单抽出奇迹！」',\n        ...data,\n      };\n    }\n    return {\n      title: '「单抽出奇迹？」',\n      ...data,\n    };\n  },\n  function gacha10Data({ gacha }) {\n    const gachaFiveStarCountArr = gacha[10].map(\n      (item) => item.data.filter((v) => v.星级 === 5).length,\n    );\n    if (gachaFiveStarCountArr.length === 0) return;\n    gachaFiveStarCountArr.sort((a, b) => b - a);\n    const fiveStarCount = gachaFiveStarCountArr[0];\n    if (fiveStarCount <= 1) return;\n    const count = gachaFiveStarCountArr.lastIndexOf(fiveStarCount) + 1; // 达成次数\n    const mapping = ['单', '双', '三', '四', '五', '六', '七', '八', '九', '十'];\n    let extraInfo = '';\n    if (fiveStarCount >= 3) extraInfo = '，你就是极致的欧皇!';\n    return {\n      title: `「${mapping[fiveStarCount - 1]}黄蛋!」`,\n      info: `在一次十连中，你抽取到了 ${fiveStarCount} 只五星${extraInfo}`,\n      value: count,\n      achievedTime: '达成次数',\n    };\n  },\n  function gacha10getMoreThanFive({ gacha }) {\n    // github issue #5  @zhsitao (https://github.com/zhsitao)\n    if (gacha[10].length === 0) return;\n    const isFit = (item: DataItem) => item.星级 >= 4;\n    function getFourFiveStarCount(data: DataItem[]) {\n      let count = 0;\n      for (let i = 0; i < data.length; i++) {\n        const item = data[i];\n        if (isFit(item)) count++;\n      }\n      return count;\n    }\n    const list = gacha[10].filter(({ data }) => {\n      return getFourFiveStarCount(data) >= 5;\n    });\n    if (list.length === 0) {\n      const countMoreThanFourList = gacha[10].filter(({ data }) => {\n        return getFourFiveStarCount(data) >= 4;\n      });\n      if (countMoreThanFourList.length === 0) return;\n      return {\n        title: '「四叶草」',\n        info: `在一次十连中，抽取到 4 个或以上的 4 星或 5 星`,\n        value: `${countMoreThanFourList.length}`,\n        achievedTime: `达成次数`,\n      };\n    }\n    return {\n      title: '「福至五彩」',\n      info: `在一次十连中，抽取到 5 个或以上的 4 星或 5 星`,\n      value: `${list.length}`,\n      achievedTime: `达成次数`,\n    };\n  },\n  function characterMoreThanWeapon({ gacha }) {\n    // github issue #5  @zhsitao (https://github.com/zhsitao)\n    if (gacha[10].length === 0) return;\n    function getWeaponCount(data: DataItem[]) {\n      let count = 0;\n      for (let i = 0; i < data.length; i++) {\n        const item = data[i];\n        if (isWeapon(item)) count++;\n      }\n      return count;\n    }\n    const list = gacha[10].filter(({ data }) => {\n      return getWeaponCount(data) <= 5;\n    });\n    if (list.length === 0) return;\n    const maxData = minBy(list, ({ data }) => getWeaponCount(data))!;\n    const maxCount = 10 - getWeaponCount(maxData.data);\n    return {\n      title: '「这才是角色池！」',\n      info: `在一次十连中，抽出的角色不少于武器`,\n      value: `角色：${maxCount}`,\n      achievedTime: `${maxData.data[0].时间}`,\n    };\n  },\n  function maxFiveStarCharacter({ character }) {\n    const sortedData = Object.values(character[5]).sort((b, a) => a.data.length - b.data.length);\n    if (sortedData.length === 0) return;\n    const maxNum = sortedData[0].data.length;\n    if (maxNum === 1) return;\n    const endIndex = sortedData.findIndex((v) => v.data.length !== maxNum);\n    const names = sortedData\n      .slice(0, endIndex)\n      .map((item) => defaultFormatter(item.data[0].名称, item.data.length));\n    return {\n      title: '「情有独钟(五星角色)」',\n      info: `你共抽取了 ${names.join('、')}，这是上天对你的眷顾还是你对${\n        names.length === 1 ? ' ta ' : '他们'\n      }的情有独钟呢？`,\n    };\n  },\n  function maxFourStarCharacter({ character }) {\n    const sortedData = Object.values(character[4]).sort((b, a) => a.data.length - b.data.length);\n    if (sortedData.length === 0) return;\n    const maxNum = sortedData[0].data.length;\n    if (maxNum === 1) return;\n    const endIndex = sortedData.findIndex((v) => v.data.length !== maxNum);\n    const names = sortedData\n      .slice(0, endIndex)\n      .map((item) => defaultFormatter(item.data[0].名称, item.data.length));\n    return {\n      title: '「情有独钟(四星角色)」',\n      info: `你共抽取了 ${names.join('、')}，这是上天对你的眷顾还是你对${\n        names.length === 1 ? ' ta ' : '他们'\n      }的情有独钟呢？`,\n    };\n  },\n];\n","/**\n * render achievements to canvas\n * 先定位再绘制，因此很多都返回{width:xxx, draw} 格式，调用draw时才绘制\n */\n/** @jsxImportSource @emotion/react */\nimport { AchievementCardProps } from 'components/AchievementCard';\nimport { FONT_FAMILY, FONT_FAMILY_BOLD } from 'const';\nimport AchievedPng from 'resource/achievement_achieved.png';\nimport ShowPng from 'resource/achievement_show.png';\n// @ts-ignore\n\nconst WIDTH = 750;\n\nfunction getFont(size: number) {\n  return `${size}px ${FONT_FAMILY_BOLD},${FONT_FAMILY}`;\n}\n// draw text auto change line\nfunction drawText(\n  ctx: CanvasRenderingContext2D,\n  {\n    text,\n    width,\n    letterSpace = 0,\n    lineHeight,\n    ...props\n  }: {\n    text: string;\n    width?: number;\n    letterSpace?: number;\n    lineHeight?: number;\n    font: CanvasRenderingContext2D['font'];\n    fillStyle: CanvasRenderingContext2D['fillStyle'];\n    textBaseline?: CanvasRenderingContext2D['textBaseline'];\n    textAlign?: CanvasRenderingContext2D['textAlign'];\n  },\n) {\n  const loc = {\n    x: 0,\n    y: 0,\n  };\n  const chars = text.split('');\n  if (lineHeight === undefined) {\n    const match = props.font.match(/\\d\\dpx/);\n    if (match === null) throw new Error('match error');\n    else lineHeight = parseFloat(match[0]) * 1.3;\n  }\n  const data: Array<{\n    char: string;\n    x: number;\n    y: number;\n  }> = [];\n  const save: Array<{\n    key: string;\n    v: string;\n  }> = [];\n  function restore() {\n    save.forEach(({ key, v }) => {\n      (ctx as any)[key] = v;\n    });\n  }\n  Object.keys(props).forEach((key) => {\n    const v = (ctx as any)[key];\n    if (v !== (props as any)[key]) {\n      save.push({\n        key,\n        v,\n      });\n      (ctx as any)[key] = (props as any)[key];\n    }\n  });\n  if (width === undefined) {\n    for (let i = 0; i < chars.length; i++) {\n      const char = chars[i];\n      const { width: charWidth } = ctx.measureText(char);\n      data.push({\n        char,\n        x: loc.x,\n        y: loc.y,\n      });\n      loc.x += charWidth + letterSpace;\n    }\n  } else {\n    for (let i = 0; i < chars.length; i++) {\n      const char = chars[i];\n      const { width: charWidth } = ctx.measureText(char);\n      if (loc.x + charWidth + letterSpace > width) {\n        loc.y += lineHeight;\n        loc.x = 0;\n        i--;\n      } else {\n        data.push({\n          char,\n          x: loc.x,\n          y: loc.y,\n        });\n        loc.x += charWidth + letterSpace;\n      }\n    }\n  }\n  restore();\n  return {\n    draw(x: number, y: number) {\n      Object.keys(props).forEach((key) => {\n        (ctx as any)[key] = (props as any)[key];\n      });\n      data.forEach(({ char, x: sx, y: sy }) => {\n        ctx.fillText(char, x + sx, y + sy);\n      });\n      restore();\n    },\n    width: width === undefined ? loc.x - letterSpace : width,\n    height: loc.y + lineHeight,\n  };\n}\n// loadImage to avoid async\nconst loadImage = (function () {\n  const cache: {\n    [key: string]: HTMLImageElement;\n  } = Object.create(null);\n  const loading: {\n    [key: string]: Array<(image: HTMLImageElement) => void>;\n  } = Object.create(null);\n  function loadImage(src: string, cb: (image: HTMLImageElement) => void): void;\n  function loadImage(src: string[], cb: (image: HTMLImageElement[]) => void): void;\n  function loadImage(src: any, cb: any) {\n    if (Array.isArray(src)) {\n      let i = 0;\n      const data: HTMLImageElement[] = [];\n      src.forEach((str) => {\n        loadImage(str, (image) => {\n          data[i] = image;\n          i++;\n          if (i === src.length) cb(data);\n        });\n      });\n      return;\n    }\n    if (src in cache) {\n      cb(cache[src]);\n    } else {\n      if (src in loading) loading[src].push(cb);\n      else {\n        loading[src] = [cb];\n        const image = new Image();\n        image.src = src;\n        image.onload = function (e) {\n          const data = loading[src];\n          delete loading[src];\n          cache[src] = image;\n          data.forEach((f) => f(image));\n        };\n        image.onerror = function (e) {\n          delete loading[src];\n        };\n      }\n    }\n  }\n  return loadImage;\n})();\nfunction drawImage(\n  ctx: CanvasRenderingContext2D,\n  src: string,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  callback?: () => void,\n) {\n  const cb = function (image: HTMLImageElement) {\n    ctx.drawImage(image, x, y, width, height);\n    callback && callback();\n  };\n  loadImage(src, cb);\n}\n\nfunction drawOneAchievement(ctx: CanvasRenderingContext2D, achievement: AchievementCardProps) {\n  const HEIGHT = 108;\n  const BORDER_WIDTH = 2;\n  const MARGIN_H = 4;\n  const MARGIN_W = 8;\n  const BORDER_MARGIN_W = BORDER_WIDTH + MARGIN_W;\n  const BORDER_MARGIN_H = BORDER_WIDTH + MARGIN_H;\n  const { width: LEFT_ZONE_WIDTH, draw: drawLeft } = drawLeftZone(ctx);\n  const { width: RIGHT_ZONE_WIDTH, draw: drawRight } = drawRightZone(ctx, {\n    value: achievement.value,\n    achievedTime: achievement.achievedTime,\n  });\n  const contentWidth = WIDTH - 2 * BORDER_MARGIN_W - LEFT_ZONE_WIDTH - RIGHT_ZONE_WIDTH;\n  const { height: fontHeight, draw: drawContent } = drawContentZone(ctx, {\n    width: contentWidth,\n    info: achievement.info,\n    title: achievement.title,\n  });\n  const contentHeight = Math.max(fontHeight, HEIGHT - 2 * BORDER_WIDTH - 2 * MARGIN_H);\n  return {\n    height: contentHeight + 2 * BORDER_WIDTH + 2 * MARGIN_H,\n    draw(x: number, y: number) {\n      ctx.textBaseline = 'top';\n      ctx.fillStyle = '#ebe2d8';\n      ctx.fillRect(\n        x + BORDER_MARGIN_W,\n        y + BORDER_MARGIN_H,\n        WIDTH - 2 * BORDER_MARGIN_W,\n        contentHeight,\n      );\n      ctx.strokeStyle = '#e0d6cb';\n      ctx.lineWidth = BORDER_WIDTH;\n      ctx.lineJoin = 'round';\n      const tmp_w = MARGIN_W + BORDER_WIDTH / 2;\n      const tmp_h = MARGIN_H + BORDER_WIDTH / 2;\n      ctx.strokeRect(x + tmp_w, y + tmp_h, WIDTH - 2 * tmp_w, contentHeight + BORDER_WIDTH);\n      drawLeft(x + BORDER_MARGIN_W, y + BORDER_MARGIN_H, contentHeight);\n      drawContent(x + BORDER_MARGIN_W + LEFT_ZONE_WIDTH, y + BORDER_MARGIN_H, contentHeight);\n      drawRight(x + WIDTH - BORDER_MARGIN_W, y + BORDER_MARGIN_H, contentHeight);\n    },\n  };\n}\n// draw left logo\nfunction drawLeftZone(ctx: CanvasRenderingContext2D) {\n  const IMAGE_WIDTH = 104;\n  const IMAGE_HEIGHT = 104;\n  const SIZE = 80;\n  const WIDTH = SIZE;\n  const HEIGHT = SIZE;\n  const LEFT_PADDING = 16;\n  const RIGHT_PADDING = 16;\n  return {\n    width: LEFT_PADDING + WIDTH + RIGHT_PADDING,\n    draw(left: number, top: number, contentHeight: number) {\n      drawImage(\n        ctx,\n        AchievedPng,\n        left + LEFT_PADDING,\n        top + contentHeight / 2 - HEIGHT / 2,\n        WIDTH,\n        HEIGHT,\n      );\n    },\n  };\n}\n// draw text\nfunction drawContentZone(\n  ctx: CanvasRenderingContext2D,\n  {\n    width,\n    title,\n    info,\n  }: {\n    width: number;\n    title: string;\n    info: string;\n  },\n) {\n  const PADDING_TOP = 12;\n  const PADDING_BOTTOM = 12;\n  const SPACE = 8;\n  const { height: titleHeight, draw: drawTitle } = drawText(ctx, {\n    text: title,\n    width,\n    fillStyle: '#585757',\n    font: getFont(20),\n  });\n  const { height: infoHeight, draw: drawInfo } = drawText(ctx, {\n    text: info,\n    width,\n    fillStyle: '#988b81',\n    font: getFont(16),\n  });\n  const height = titleHeight + SPACE + infoHeight;\n  return {\n    height: PADDING_TOP + height + PADDING_BOTTOM,\n    draw(left: number, top: number, contentHeight: number) {\n      let x = left,\n        y = top + contentHeight / 2 - height / 2;\n      drawTitle(x, y);\n      y += titleHeight + SPACE;\n      drawInfo(x, y);\n    },\n  };\n}\n// draw right zone\nfunction drawRightZone(\n  ctx: CanvasRenderingContext2D,\n  {\n    achievedTime,\n    value,\n  }: {\n    value?: string | number;\n    achievedTime?: string;\n  },\n) {\n  const IMAGE_WIDTH = 147;\n  const IMAGE_HEIGHT = 115;\n  const HEIGHT = 96;\n  const WIDTH = 140;\n  const realImageWidth = (HEIGHT / IMAGE_HEIGHT) * IMAGE_WIDTH;\n  return {\n    width: WIDTH,\n    draw(right: number, top: number, contentHeight: number) {\n      function drawValue() {\n        if (value !== undefined) {\n          const { width, draw } = drawText(ctx, {\n            text: value.toString(),\n            font: getFont(20),\n            fillStyle: '#988b81',\n            textBaseline: 'middle',\n          });\n          draw(right - realImageWidth / 2 - width / 2, top + contentHeight / 2);\n        }\n      }\n      if (achievedTime) {\n        drawImage(\n          ctx,\n          ShowPng,\n          right - realImageWidth,\n          top + contentHeight / 2 - HEIGHT / 2,\n          realImageWidth,\n          HEIGHT,\n          () => {\n            drawValue();\n            const { width, draw } = drawText(ctx, {\n              text: achievedTime,\n              font: getFont(15),\n              fillStyle: '#988b81',\n              textBaseline: 'middle',\n            });\n            draw(right - realImageWidth / 2 - width / 2, top + contentHeight / 2 + 34);\n          },\n        );\n      } else drawValue();\n    },\n  };\n}\n\nfunction drawEndLine(ctx: CanvasRenderingContext2D) {\n  const LINE_PADDING = 20;\n  const { width: fontWidth, height, draw } = drawText(ctx, {\n    text: 'https://genshin-gacha-analyzer.vercel.app/',\n    font: `13px ${FONT_FAMILY}`,\n    fillStyle: '#988b81',\n    letterSpace: 1,\n    textBaseline: 'middle',\n  });\n  const HEIGHT = 20;\n  return {\n    height: HEIGHT,\n    draw(top: number) {\n      ctx.fillStyle = '#585757';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = 2;\n      const centerY = top + HEIGHT / 2;\n      ctx.beginPath();\n      ctx.moveTo(LINE_PADDING, centerY);\n      ctx.lineTo(WIDTH / 2 - fontWidth / 2 - LINE_PADDING, centerY);\n      ctx.closePath();\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(WIDTH / 2 + fontWidth / 2 + LINE_PADDING, centerY);\n      ctx.lineTo(WIDTH - LINE_PADDING, centerY);\n      ctx.closePath();\n      ctx.stroke();\n      draw(WIDTH / 2 - fontWidth / 2, centerY);\n    },\n  };\n}\nexport function renderToCanvas(\n  achievements: AchievementCardProps[],\n  cb: (canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D) => void,\n) {\n  const canvas = document.createElement('canvas');\n  const ctx: CanvasRenderingContext2D = canvas.getContext('2d', {\n    alpha: false,\n  }) as any;\n  loadImage([AchievedPng, ShowPng], (data) => {\n    const TOP_BOTTOM_PADDING = 2;\n    let x = 0,\n      y = TOP_BOTTOM_PADDING;\n    const draws = []; // store draw method\n    for (let i = 0; i < achievements.length; i++) {\n      const item = achievements[i];\n      const { height, draw } = drawOneAchievement(ctx, item);\n      draws.push(\n        (function (sx, sy) {\n          return () => void draw(sx, sy);\n        })(x, y),\n      );\n      y += height;\n    }\n    const { height: endLineHeight, draw: drawEnd } = drawEndLine(ctx);\n    canvas.width = WIDTH;\n    canvas.height = y + TOP_BOTTOM_PADDING + endLineHeight;\n    ctx.fillStyle = '#f0eae2';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    draws.forEach((f) => f());\n    drawEnd(y);\n    cb(canvas, ctx);\n  });\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Button, Divider, message } from 'antd';\nimport { AchievementCard, AchievementCardProps } from 'components/AchievementCard';\nimport { IconButton } from 'components/IconButton';\nimport ShareAltOutlined from '@ant-design/icons/ShareAltOutlined';\nimport FormOutlined from '@ant-design/icons/FormOutlined';\nimport MinusCircleTwoTone from '@ant-design/icons/MinusCircleTwoTone';\nimport PlusCircleTwoTone from '@ant-design/icons/PlusCircleTwoTone';\nimport CloseOutlined from '@ant-design/icons/CloseOutlined';\nimport { FONT_FAMILY_BOLD, FONT_FAMILY, SHOW_DATA_ALL_KEY, ISMOBILE } from 'const';\nimport React, { FC, useCallback, useMemo, useState } from 'react';\nimport { Data, DataItem, StarCacheType, GachaCacheType, DayCacheType } from 'types';\nimport { achievements as achievementsFunc } from './achievements';\nimport { renderToCanvas } from './renderToCanvas';\n//@ts-ignore\nimport { saveAs } from 'file-saver';\nimport { useCacheMemo } from 'context/CacheContext';\nimport { FriendLinks } from 'components/FriendLinks';\nimport renderPngTip from 'utils/renderPngTip';\n\ntype AchievementsProps = {\n  onGetData: (key: string) => Data;\n  sheetNames: string[];\n};\n\nexport const POOLS = {\n  CHARACTER: 0,\n  WEAPON: 1,\n  PERMANENT: 2,\n  NOVICE: 3,\n};\nexport const EN_SHEETS = [\n  'Character Event Wish',\n  'Weapon Event Wish',\n  'Permanent Wish',\n  'Novice Wish',\n];\nexport const CN_SHEETS = ['角色活动祈愿', '武器活动祈愿', '常驻祈愿', '新手祈愿'];\nfunction getSheetKey(key: any, sheetNames: string[]) {\n  const isChinese = CN_SHEETS.indexOf(sheetNames[0]) !== -1;\n  return isChinese ? CN_SHEETS[key] : sheetNames[key];\n}\nconst iconCss = css`\n  position: absolute;\n  left: 0;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  font-size: 24px;\n  padding: 10px;\n`;\nconst WrappedAchievementCard: FC<{\n  isEditMode: boolean;\n  visible: boolean;\n  item: AchievementCardProps & {\n    visible: boolean;\n  };\n}> = function ({ isEditMode, item, visible }) {\n  const [isVisible, setVisible] = useState(visible);\n  const handleHide = useCallback(() => {\n    setVisible(!isVisible);\n    item.visible = !isVisible;\n  }, [isVisible]);\n  return (\n    <div style={{ opacity: isVisible ? 1 : 0.5, position: 'relative' }}>\n      <AchievementCard {...item}>\n        {isEditMode &&\n          (isVisible ? (\n            <MinusCircleTwoTone twoToneColor='#ee675c' css={iconCss} onClick={handleHide} />\n          ) : (\n            <PlusCircleTwoTone twoToneColor='#5bb974' css={iconCss} onClick={handleHide} />\n          ))}\n      </AchievementCard>\n    </div>\n  );\n};\nexport const Achievements: FC<AchievementsProps> = function ({ onGetData, sheetNames }) {\n  const allAchievements = useCacheMemo(\n    () => {\n      const allData = onGetData(SHOW_DATA_ALL_KEY);\n      // 将数据分散到表里面，做一个缓存处理，方便对数据进行筛选\n      const character: StarCacheType = {\n        '5': {},\n        '4': {},\n      };\n      const all: StarCacheType = {\n        '5': {},\n        '4': {},\n        '3': {},\n      };\n      const weapon: StarCacheType = {\n        '5': {},\n        '4': {},\n        '3': {},\n      };\n      const day: DayCacheType = {};\n      const gacha: GachaCacheType = {\n        10: [],\n        1: [],\n      };\n      const pools = {\n        character: onGetData(getSheetKey(POOLS.CHARACTER, sheetNames)),\n        weapon: onGetData(getSheetKey(POOLS.WEAPON, sheetNames)),\n        novice: onGetData(getSheetKey(POOLS.NOVICE, sheetNames)),\n        permanent: onGetData(getSheetKey(POOLS.PERMANENT, sheetNames)),\n      };\n      const walk = (item: DataItem) => {\n        let cache = item.类别 === '角色' ? character : weapon;\n        if (item.名称 in all[item.星级]) all[item.星级][item.名称].data.push(item);\n        else {\n          all[item.星级][item.名称] = {\n            data: [item],\n          };\n        }\n        const currentDay = item.时间.slice(0, 10);\n        if (currentDay in day) {\n          day[currentDay].data.push(item);\n        } else {\n          day[currentDay] = { data: [item] };\n        }\n        if (!(item.名称 in cache[item.星级])) {\n          cache[item.星级][item.名称] = {\n            data: [item],\n          };\n        } else cache[item.星级][item.名称].data.push(item);\n      };\n      for (let i = 0, len = allData.length; i < len; ) {\n        const current = allData[i];\n        if (i < len - 1 && allData[i + 1].date === current.date) {\n          const temp = allData.slice(i, i + 10);\n          temp.forEach(walk);\n          gacha[10].push({\n            data: temp,\n          });\n          i = i + 10;\n        } else {\n          walk(current);\n          gacha[1].push(current);\n          i++;\n        }\n      }\n      const info = {\n        all,\n        character,\n        weapon,\n        data: allData,\n        gacha,\n        day,\n        pools,\n      };\n      if (process.env.NODE_ENV === 'development') console.log(info);\n      const isDate = (str: string) => new Date(str).toString() !== 'Invalid Date';\n      const result = achievementsFunc\n        .map((func) => func(info))\n        .reduce((acc: Array<any>, cur: any) => {\n          if (Array.isArray(cur)) return acc.concat(cur);\n          if (typeof cur === 'object') acc.push(cur);\n          return acc;\n        }, []);\n      result.forEach((data) => {\n        const achievedTime = data.achievedTime;\n        if (achievedTime && isDate(achievedTime)) {\n          data.achievedTime = achievedTime.slice(0, 10).replace(/-/g, '/');\n        }\n        data.visible = true;\n      });\n      return result;\n    },\n    [],\n    'achievements',\n  );\n  const [achievements, setAchievements] = useState(allAchievements);\n  const [isEditMode, setEditMode] = useState(false);\n  const handleRenderPng = useCallback(() => {\n    const data = achievements.filter((item) => item.visible !== false);\n    renderPngTip((resolve, reject) => {\n      renderToCanvas(data, (canvas, ctx) => {\n        canvas.toBlob(function (blob) {\n          saveAs(blob, 'achievements.png');\n          resolve();\n        });\n      });\n    });\n  }, [achievements]);\n  const handleEdit = useCallback(() => {\n    setEditMode(!isEditMode);\n    if (!isEditMode) {\n      message.info('进入编辑模式，可以设置单个成就是否展示');\n      setAchievements(allAchievements);\n    } else setAchievements(allAchievements.filter((item) => item.visible));\n  }, [isEditMode]);\n  return (\n    <div\n      css={css`\n        background: #f0eae2;\n        width: 100%;\n        height: 100%;\n        overflow-y: auto;\n        overflow-x: hidden;\n        position: absolute;\n        font-family: ${FONT_FAMILY_BOLD}, ${FONT_FAMILY};\n      `}\n    >\n      {!ISMOBILE && (\n        <div\n          css={css`\n            position: fixed;\n            right: 8%;\n            z-index: 999;\n            top: 64px;\n          `}\n        >\n          <IconButton\n            placement='right'\n            tip='生成图片'\n            icon={<ShareAltOutlined />}\n            onClick={handleRenderPng}\n          />\n          <br />\n          <IconButton\n            placement='right'\n            tip={isEditMode ? '退出编辑' : '编辑成就'}\n            icon={isEditMode ? <CloseOutlined /> : <FormOutlined />}\n            onClick={handleEdit}\n          />\n        </div>\n      )}\n      {achievements.map((props) => (\n        <WrappedAchievementCard\n          key={props.title}\n          item={props}\n          visible={props.visible}\n          isEditMode={isEditMode}\n        />\n      ))}\n      <Button\n        type='primary'\n        css={css`\n          display: block;\n          margin: 10px auto;\n        `}\n        onClick={handleRenderPng}\n      >\n        生成图片\n      </Button>\n      <Divider>\n        <a href='https://github.com/voderl/genshin-gacha-analyzer/issues' target='_blank'>\n          更多成就开发中，欢迎前往issue提出你的建议...\n        </a>\n      </Divider>\n      <FriendLinks mode='bottom' />\n    </div>\n  );\n};\n","/** Sider 电脑端手机端对应不同的侧边栏 */\n/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, memo } from 'react';\nimport { Layout, Menu } from 'antd';\nimport RawGithubCorner from 'react-github-corner';\nimport BarChartOutlined from '@ant-design/icons/BarChartOutlined';\nimport UnorderedListOutlined from '@ant-design/icons/UnorderedListOutlined';\nimport StarOutlined from '@ant-design/icons/StarOutlined';\nimport PieChartOutlined from '@ant-design/icons/PieChartOutlined';\nimport { FriendLinks } from 'components/FriendLinks';\n\nconst { Sider, Header } = Layout;\n\ninterface CustomSiderProps {\n  isVertical: boolean;\n  activeMenu: string;\n  onMenuChange: ({ key }: any) => any;\n}\n\nconst GithubCorner = memo(\n  () => (\n    <RawGithubCorner\n      href='https://github.com/voderl/genshin-gacha-analyzer'\n      target='_blank'\n      direction='left'\n      bannerColor='#70B7FD'\n      octoColor='#fff'\n      size={60}\n    />\n  ),\n  () => true,\n);\n\nconst isVerticalMenuStyle = css`\n  .ant-menu-item {\n    margin: 0 10px !important;\n    height: 48px;\n    line-height: 48px;\n  }\n`;\nconst notIsVerticalMenuStyle = css`\n  margin-top: 80px;\n  .ant-menu-item {\n    height: 60px;\n    line-height: 60px;\n  }\n`;\nconst CustomSider: FC<CustomSiderProps> = ({ isVertical, onMenuChange, activeMenu }) => {\n  const children = [\n    <GithubCorner />,\n    <Menu\n      mode={isVertical ? 'horizontal' : 'inline'}\n      defaultSelectedKeys={[activeMenu]}\n      onSelect={onMenuChange}\n      css={isVertical ? isVerticalMenuStyle : notIsVerticalMenuStyle}\n    >\n      <Menu.Item key='timeline' icon={<BarChartOutlined />}>\n        时间轴\n      </Menu.Item>\n      <Menu.Item key='analysisChart' icon={<PieChartOutlined />}>\n        分析图\n      </Menu.Item>\n      <Menu.Item key='rawData' icon={<UnorderedListOutlined />}>\n        原数据\n      </Menu.Item>\n      <Menu.Item key='achievements' icon={<StarOutlined />}>\n        成就表\n      </Menu.Item>\n    </Menu>,\n  ];\n  if (isVertical)\n    return (\n      <Header\n        css={css`\n          padding-right: 0px;\n          background: #fff;\n          line-height: 56px;\n        `}\n      >\n        {children}\n      </Header>\n    );\n  return (\n    <Sider\n      breakpoint='lg'\n      theme='light'\n      width='15%'\n      style={{\n        height: '100vh',\n      }}\n    >\n      {children}\n      <FriendLinks mode='left' />\n    </Sider>\n  );\n};\n\nexport default CustomSider;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, useCallback, useMemo, useState, Suspense, lazy, memo } from 'react';\nimport { Layout, Spin } from 'antd';\nimport XLSXType, { WorkSheet as WorkSheetType } from 'xlsx/types';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport { SHOW_DATA_ALL_KEY } from 'const';\nimport { Data, DataItem } from 'types';\nimport { Achievements } from './Achievements';\nimport CustomSider from './CustomSider';\nimport { CacheContextProvider } from 'context/CacheContext';\n\nconst ShowData = lazy(() =>\n  import(/* webpackPrefetch: true */ './ShowData').then((module) => ({\n    default: module.ShowData,\n  })),\n);\nconst Timeline = lazy(() =>\n  import(/* webpackPrefetch: true */ './Timeline').then((module) => ({\n    default: module.Timeline,\n  })),\n);\nconst AnalysisChart = lazy(() =>\n  import(/* webpackPrefetch: true */ './AnalysisChart').then((module) => ({\n    default: module.AnalysisChart,\n  })),\n);\n\ntype ShowPageProps = {};\nconst { Content } = Layout;\n\nexport const ShowPage: FC<ShowPageProps> = function () {\n  const { workbook, isVertical } = useGlobalContext();\n  const sheetNames = (workbook as any).SheetNames;\n  const getJson = useMemo(() => {\n    const cache = Object.create(null);\n    function getJson(key: string) {\n      const XLSX: typeof XLSXType = (window as any).XLSX;\n      if (key in cache) return cache[key];\n      let data: Data;\n      if (key === SHOW_DATA_ALL_KEY) {\n        data = sheetNames.reduce((acc: Array<any>, cur: string) => acc.concat(getJson(cur)), []);\n        data.sort((a, b) => (a.date === b.date ? a.总次数 - b.总次数 : a.date - b.date));\n      } else {\n        const sheet = (workbook as any).Sheets[key] as WorkSheetType;\n        data = XLSX.utils.sheet_to_json(sheet);\n        data.forEach((info: DataItem) => {\n          info.pool = key;\n          info.date = +new Date(info.时间);\n          (['编号', '总次数', '星级', '保底内'] as Array<keyof DataItem>).forEach((key) => {\n            if (typeof info[key] !== 'number') (info as any)[key] = parseInt((info as any)[key]);\n          });\n        });\n      }\n      return (cache.key = data);\n    }\n    return getJson;\n  }, [workbook]);\n  const [activeMenu, setActiveMenu] = useState('rawData');\n  const handleMenuChange = useCallback(({ key }: any) => {\n    setActiveMenu(key);\n  }, []);\n  const renderContent = useCallback((key) => {\n    if (key === 'rawData') return <ShowData onGetData={getJson} tabs={sheetNames} />;\n    else if (key === 'analysisChart')\n      return <AnalysisChart sheetNames={sheetNames} onGetData={getJson} />;\n    else if (key === 'timeline') return <Timeline onGetData={getJson} />;\n    else if (key === 'achievements')\n      return <Achievements onGetData={getJson} sheetNames={sheetNames} />;\n    else return <div>暂无</div>;\n  }, []);\n  return (\n    <Layout\n      css={css`\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        display: flex;\n      `}\n      style={{\n        flexDirection: isVertical ? 'column' : 'row',\n      }}\n    >\n      <CustomSider\n        isVertical={isVertical}\n        onMenuChange={handleMenuChange}\n        activeMenu={activeMenu}\n      />\n      <Content\n        css={css`\n          margin: 0;\n          position: relative;\n          width: 100%;\n          height: 100%;\n          overflow-x: hidden;\n          overflow-y: auto;\n        `}\n      >\n        <CacheContextProvider path={activeMenu}>\n          <Suspense\n            fallback={\n              <Spin\n                size='large'\n                tip='加载中...'\n                css={css`\n                  display: block;\n                  margin: 150px auto;\n                `}\n              />\n            }\n          >\n            {renderContent(activeMenu)}\n          </Suspense>\n        </CacheContextProvider>\n      </Content>\n    </Layout>\n  );\n};\n","import { reject } from 'lodash';\nimport qs from 'query-string';\nimport XLSXNameSpace from 'xlsx/types';\n// @ts-ignore\nimport saveAs from 'file-saver';\n// mihoyo api\nexport type Message = { type: 'error' | 'warning' | 'info'; text: string };\ntype Log = (data: Message) => void;\nconst emptyLog = (data: Message) => void 0;\nconst logRef: {\n  current: Log;\n} = {\n  current: emptyLog,\n};\nconst message = {\n  info: (text: string) =>\n    logRef.current({\n      type: 'info',\n      text,\n    }),\n  warning: (text: string) =>\n    logRef.current({\n      type: 'warning',\n      text,\n    }),\n  error: (text: string) =>\n    logRef.current({\n      type: 'error',\n      text,\n    }),\n};\ntype Info = {\n  apiDomain: string;\n  query: {\n    [key: string]: string | number;\n  };\n};\nexport default function parseUrl(inputUrl: string, log?: Log) {\n  try {\n    if (log) logRef.current = log;\n    else logRef.current = emptyLog;\n    let apiDomain = 'https://hk4e-api.mihoyo.com';\n    const { url, query } = qs.parseUrl(inputUrl);\n    if (url.includes('webstatic-sea') || url.includes('hk4e-api-os'))\n      apiDomain = 'https://hk4e-api-os.mihoyo.com';\n    if (!('authkey' in query)) return message.error('未在url中发现authkey');\n    ['page', 'size', 'gacha_type', 'end_id'].forEach((key) => {\n      if (key in query) delete query[key];\n    });\n    query.lang = 'zh-cn';\n    const info = {\n      apiDomain,\n      query,\n    };\n    return () => {\n      main(info as any);\n    };\n  } catch (e) {\n    message.error('输入内容解析错误，请重新输入');\n  }\n}\n\nconst wishTypeMap = {\n  '301': '角色活动祈愿',\n  '302': '武器活动祈愿',\n  '200': '常驻祈愿',\n  '100': '新手祈愿',\n};\n\nfunction main(info: Info) {\n  message.info('加载XLSX解析文件中...');\n  // @ts-ignore\n  import('xlsx/dist/xlsx.mini.min.js')\n    .then((module) => {\n      const XLSX: typeof XLSXNameSpace = module;\n      const workbook = XLSX.utils.book_new();\n      const title = ['时间', '名称', '类别', '星级', '总次数', '保底内'];\n      getGachaType(info).then((types: any) => {\n        Promise.all(\n          types.map((type: any) => {\n            const { name, key } = type;\n            return getGachaLogs(info, name, key).then((list: any) => {\n              let pdx = 0;\n              const data = list.map((item: any, index: number) => {\n                pdx++;\n                const star = parseInt(item.rank_type);\n                if (star === 5) pdx = 0;\n                return [item.time, item.name, item.item_type, star, index + 1, pdx];\n              });\n              data.unshift(title);\n              const ws = XLSX.utils.aoa_to_sheet(data);\n              XLSX.utils.book_append_sheet(workbook, ws, name);\n            });\n          }),\n        ).then(() => {\n          const wbout = XLSX.write(workbook, { bookType: 'xlsx', bookSST: false, type: 'array' });\n          saveAs(new Blob([wbout], { type: 'application/octet-stream' }), 'test.xlsx');\n        });\n      });\n    })\n    .catch(() => {\n      message.error('XLSX解析文件加载失败，请重试');\n    });\n}\n// function fetch() {\n//   return new Promise((resolve, reject) => resolve)\n// }\nfunction request(\n  baseUrl: string,\n  params: {\n    [key: string]: string | number;\n  },\n) {\n  const left = 3;\n  const retryDelay = 100;\n  const url = qs.stringifyUrl({\n    url: baseUrl,\n    query: params,\n  });\n  return new Promise((resolve, reject) => {\n    function wrappedFetch(attempt: number) {\n      fetch(url, {\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8',\n        },\n      })\n        .then(function (response) {\n          console.log(response);\n          resolve(response.json());\n        })\n        .catch(function (e) {\n          if (++attempt >= left) reject(e);\n          else {\n            setTimeout(() => {\n              wrappedFetch(attempt);\n            }, retryDelay);\n          }\n        });\n    }\n    wrappedFetch(0);\n  });\n}\n\nconst order = ['301', '302', '200', '100'];\nfunction getGachaType(info: Info) {\n  return new Promise((resolve, reject) => {\n    message.info('获取祈愿类型中...');\n    request(`${info.apiDomain}/event/gacha_info/api/getConfigList`, info.query)\n      .then((res: any) => {\n        const gachaTypes = res.data.gacha_type_list;\n        const orderedGachaTypes = [];\n        order.forEach((key) => {\n          const index = gachaTypes.findIndex((item: any) => item.key === key);\n          if (index !== -1) {\n            orderedGachaTypes.push(gachaTypes.splice(index, 1)[0]);\n          }\n        });\n        orderedGachaTypes.push(...gachaTypes);\n        resolve(orderedGachaTypes);\n      })\n      .catch((e) => {\n        message.error('获取祈愿类型失败');\n        reject(e);\n      });\n  });\n}\n\nfunction isEnd(list: any) {\n  if (list.length === 0) return true;\n  return false;\n}\nfunction getGachaLogs(info: Info, name: string, code: number) {\n  const data: any[] = [];\n  let page = 1;\n  let end_id = 0;\n  return new Promise((resolve, reject) => {\n    message.info(`准备获取「${name}」数据`);\n    function log() {\n      getGachaLog(info, code, page, end_id)\n        .then((list: any) => {\n          if (isEnd(list)) {\n            resolve(data);\n            message.info(`成功获取「${name}」数据`);\n            return;\n          }\n          data.push(...list);\n          message.info(`成功获取「${name}」第 ${page} 页`);\n          page += 1;\n          end_id = list.length > 0 ? list[list.length - 1].id : 0;\n          setTimeout(log);\n        })\n        .catch((e) => {\n          reject(e);\n          message.error(`获取「${name}」第 ${page} 页失败`);\n        });\n    }\n    log();\n  });\n}\n\nfunction getGachaLog(info: Info, code: number, page: number, end_id: number) {\n  return new Promise((resolve, reject) => {\n    request(`${info.apiDomain}/event/gacha_info/api/getGachaLog`, {\n      ...info.query,\n      gacha_type: code,\n      page,\n      end_id,\n      size: 20,\n    })\n      .then((res: any) => resolve(res.data.list))\n      .catch(reject);\n  });\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FC, useCallback, useMemo, useRef, useState } from 'react';\nimport { Button, Alert, Input } from 'antd';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport { FriendLinks } from 'components/FriendLinks';\nimport parseUrl, { Message } from './parseUrl';\nimport debounce from 'lodash/debounce';\n\ntype DownloadPageProps = {\n  onLoad?: () => void;\n};\n// 预加载\n// @ts-ignore\nimport('xlsx/dist/xlsx.mini.min.js');\n\nexport const DownloadPage: FC<DownloadPageProps> = function ({ onLoad }) {\n  const [loading, setLoading] = useState<Boolean>(false);\n  const [message, setMessage] = useState<Message>();\n  const messageHistory = useRef<Message[]>([]);\n  const exportFuncRef = useRef<any>();\n  const [isValid, setValid] = useState(false);\n  const [loadingTip, setLoadingTip] = useState('加载中...');\n  const { updateWorkbook } = useGlobalContext();\n  const handleExport = useCallback(() => {\n    exportFuncRef.current && exportFuncRef.current();\n  }, []);\n  const handleInputChange = useMemo(() => {\n    return debounce((e: React.ChangeEvent<HTMLTextAreaElement>) => {\n      const value = e.target.value;\n      let valid = false;\n      setMessage(undefined);\n      const cb = parseUrl(value, (message) => {\n        setMessage(message);\n        messageHistory.current.push(message);\n      });\n      if (typeof cb === 'function') {\n        valid = true;\n        exportFuncRef.current = cb;\n      }\n      setValid(valid);\n      console.log(cb);\n    }, 100);\n  }, []);\n  return (\n    <div\n      css={css`\n        overflow: auto;\n      `}\n    >\n      <div\n        className='ant-alert-info'\n        css={css`\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          border: none;\n          margin: 20px 0;\n        `}\n      >\n        <a href='https://ngabbs.com/read.php?tid=25657464' target='_blank'>\n          <Alert\n            message={\n              <div>\n                不知道如何获取抽卡记录导出文件？\n                <Button type='link'>请点击这里</Button>\n              </div>\n            }\n            type='info'\n            showIcon\n            banner\n          />\n        </a>\n      </div>\n      <div\n        css={css`\n          padding: 10px;\n        `}\n      >\n        <Input.TextArea\n          placeholder='test'\n          onChange={handleInputChange}\n          css={css`\n            margin: 20px 0;\n          `}\n        />\n        {isValid && (\n          <Button\n            type='primary'\n            css={css`\n              display: block;\n              margin: 10px auto;\n            `}\n            onClick={handleExport}\n          >\n            导出数据\n          </Button>\n        )}\n        {message && <Alert message={message.text} type={message.type} />}\n      </div>\n\n      <Alert\n        css={css`\n          margin: 20px auto;\n          width: 100%;\n          max-width: 600px;\n        `}\n        message={\n          <div>\n            此网站是静态网站，你的文件不会被上传到网站后台，具体代码请查看\n            <Button\n              type='link'\n              href='https://github.com/voderl/genshin-gacha-analyzer'\n              target='_blank'\n            >\n              github链接\n            </Button>\n          </div>\n        }\n        type='warning'\n        showIcon\n      />\n      <FriendLinks mode='bottom' visible />\n    </div>\n  );\n};\n","/** @jsxImportSource @emotion/react */\nimport { GlobalContextProvider, useGlobalContext } from './context/GlobalContext';\nimport { LoadPage } from './pages/LoadPage';\nimport { ShowPage } from './pages/ShowPage';\n\nimport './App.css';\nimport { DownloadPage } from 'pages/DownloadPage';\n\nfunction App() {\n  const { workbook } = useGlobalContext();\n  if (window.location.pathname === '/download') return <DownloadPage />;\n  return workbook === null ? <LoadPage /> : <ShowPage />;\n}\nfunction WrappedApp() {\n  return (\n    <GlobalContextProvider>\n      <App />\n    </GlobalContextProvider>\n  );\n}\nexport default WrappedApp;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import './polyfills';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Tooltip, TooltipProps } from 'antd';\nimport { FONT_FAMILY } from 'const';\nimport { useGlobalContext } from 'context/GlobalContext';\nimport { FC } from 'react';\n\ninterface FriendLinksProps {\n  mode: 'left' | 'bottom';\n  visible?: boolean;\n}\n\ntype LinkType = {\n  title: string;\n  link: string;\n  tip: string;\n};\n\nconst Links: LinkType[] = [\n  {\n    title: '可莉特调',\n    link: 'https://genshin.pub/',\n    tip: '一些很好用的原神工具~',\n  },\n];\nconst EllipsisStyle = css`\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n`;\nconst Separator = () => <>/</>;\nexport const FriendLinks: FC<FriendLinksProps> = ({ mode, visible }) => {\n  const { isVertical } = useGlobalContext();\n  if (visible === false) return <></>;\n  if (mode === 'bottom') {\n    if (!isVertical && visible !== true) return <></>;\n    return (\n      <div\n        css={css`\n          text-align: center;\n          font-size: 14px;\n          padding-bottom: 12px;\n          font-family: ${FONT_FAMILY};\n        `}\n      >\n        <span>友情链接：</span>\n        {Links.reduce((acc, { title, link, tip }, index) => {\n          if (index === 0) acc.push(<Separator />);\n          acc.push(\n            <span\n              key={title}\n              css={css`\n                padding: 8px 12px;\n              `}\n            >\n              <Tooltip title={tip} placement='top'>\n                <a target='_blank' href={link}>\n                  {title}\n                </a>\n              </Tooltip>\n            </span>,\n          );\n          acc.push(<Separator />);\n          return acc;\n        }, [] as any[])}\n      </div>\n    );\n  }\n  return (\n    <div\n      css={css`\n        position: absolute;\n        width: 100%;\n        text-align: center;\n        bottom: 20px;\n        left: 0px;\n        padding: 0;\n        & > ul {\n          padding-left: 0px;\n        }\n      `}\n    >\n      <span css={EllipsisStyle}>友情链接：</span>\n      <ul>\n        {Links.map(({ title, link, tip }) => (\n          <li css={EllipsisStyle}>\n            <Tooltip title={tip} placement='right' key={title}>\n              <a target='_blank' href={link}>\n                {title}\n              </a>\n            </Tooltip>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","/**\n * 很多数据都是只计算一次，Menu Tab切换 重复挂载消耗性能， 因此使用全局缓存\n * 可以在开发模式下，控制台输入cache查看当前缓存\n */\nimport React, { useEffect, useMemo, useRef, useState, FC, useContext } from 'react';\n\ntype CacheContextType = {\n  cache: any;\n};\n\nconst createCacheContext = function () {\n  const GlobalCache = Object.create(null);\n  if (process.env.NODE_ENV === 'development') (window as any).cache = GlobalCache;\n  const CacheContext = React.createContext<CacheContextType>({\n    cache: GlobalCache,\n  });\n  const useCacheContext = function (key?: string) {\n    const { cache } = useContext(CacheContext);\n    if (key === undefined) return cache;\n    if (key in cache) return cache[key];\n    return (cache[key] = Object.create(null));\n  };\n  const useCacheState = function (state: any, key: string) {\n    const { cache } = useContext(CacheContext);\n    const [value, setValue] = useState(state);\n    if (key in cache)\n      return [\n        cache[key],\n        (v: any) => {\n          cache[key] = v;\n          setValue(v);\n        },\n      ];\n    return [\n      key in cache ? cache[key] : value,\n      (v: any) => {\n        cache[key] = v;\n        setValue(v);\n      },\n    ];\n  };\n  const useCacheMemo = function <T>(func: () => T, deps: any[], key: string): T {\n    const { cache } = useContext(CacheContext);\n    return useMemo(() => {\n      if (key in cache) return cache[key];\n      return (cache[key] = func());\n    }, deps);\n  };\n  const CacheContextProvider: FC<{\n    path: string;\n    initValue?: any;\n  }> = function ({ path, initValue, children }) {\n    const parentCache = useCacheContext();\n    if (!(path in parentCache)) parentCache[path] = initValue || Object.create(null);\n    const contextValue = useMemo(() => {\n      const cache = parentCache[path];\n      return {\n        cache,\n      };\n    }, [path, parentCache]);\n    return <CacheContext.Provider value={contextValue}>{children}</CacheContext.Provider>;\n  };\n  return {\n    CacheContextProvider,\n    useCacheContext,\n    useCacheMemo,\n    useCacheState,\n  };\n};\nconst { CacheContextProvider, useCacheContext, useCacheMemo, useCacheState } = createCacheContext();\nexport { CacheContextProvider, useCacheContext, useCacheMemo, createCacheContext, useCacheState };\n"],"sourceRoot":""}